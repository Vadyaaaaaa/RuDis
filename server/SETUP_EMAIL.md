# Настройка отправки email для Ruscord

## Быстрая настройка Gmail (5 минут)

### Шаг 1: Подготовка Gmail аккаунта

1. Откройте https://myaccount.google.com/security
2. Включите **"Двухэтапную аутентификацию"** (если еще не включена)
   - Это обязательно для создания пароля приложения

### Шаг 2: Создание пароля приложения

1. Перейдите на https://myaccount.google.com/apppasswords
2. Выберите:
   - **Приложение:** Почта
   - **Устройство:** Другое (укажите "Ruscord")
3. Нажмите "Создать"
4. **Скопируйте 16-символьный пароль** (он показывается только один раз!)

### Шаг 3: Настройка .env файла

1. Откройте файл `server/.env`
2. Замените следующие строки:

```env
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=ваш-email@gmail.com          # Ваш Gmail адрес
SMTP_PASS=xxxx xxxx xxxx xxxx          # 16-символьный пароль приложения (можно без пробелов)
SMTP_FROM=noreply@ruscord.com
```

**Пример:**
```env
SMTP_USER=example@gmail.com
SMTP_PASS=abcd efgh ijkl mnop
```

### Шаг 4: Перезапуск сервера

1. Остановите backend сервер (закройте окно PowerShell)
2. Запустите заново:
   ```bash
   cd server
   npm run dev
   ```

### Шаг 5: Проверка

1. Попробуйте зарегистрироваться в приложении
2. Код подтверждения должен прийти на указанный email
3. Проверьте папку "Спам", если письмо не пришло

---

## Альтернативные варианты

### Mailtrap (для тестирования)

1. Зарегистрируйтесь на https://mailtrap.io
2. Создайте inbox
3. Скопируйте учетные данные SMTP
4. Обновите `server/.env`:

```env
SMTP_HOST=smtp.mailtrap.io
SMTP_PORT=2525
SMTP_USER=ваш-mailtrap-user
SMTP_PASS=ваш-mailtrap-password
```

### SendGrid (для production)

1. Зарегистрируйтесь на https://sendgrid.com
2. Создайте API ключ
3. Обновите `server/.env`:

```env
SMTP_HOST=smtp.sendgrid.net
SMTP_PORT=587
SMTP_USER=apikey
SMTP_PASS=ваш-sendgrid-api-key
```

---

## Устранение проблем

### Письма не приходят

1. **Проверьте папку "Спам"**
2. Проверьте правильность настроек в `.env`
3. Убедитесь, что сервер перезапущен после изменения `.env`
4. Проверьте логи сервера на наличие ошибок

### Ошибка "Invalid login"

- Убедитесь, что используете **пароль приложения**, а не обычный пароль Gmail
- Проверьте, что двухфакторная аутентификация включена

### Ошибка "Connection timeout"

- Проверьте интернет-соединение
- Убедитесь, что порт 587 не заблокирован файрволом
- Попробуйте использовать порт 465 с `SMTP_SECURE=true`

---

## Безопасность

⚠️ **Важно:** Никогда не коммитьте файл `.env` в git! Он уже добавлен в `.gitignore`.

Для production используйте переменные окружения на сервере вместо файла `.env`.

